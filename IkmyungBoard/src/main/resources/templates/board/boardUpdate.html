<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="|${board.boardTitle} - 수정|">게시글 명 - 수정</title>

  <link rel="stylesheet" href="/css/board/boardUpdate-style.css">
  <!-- 임시로 여기다가 작성함 나중에 boardUpdate-style.css 여기로 옮길꺼임 -->
  <style>
    /* 기본 설정 */
body {
  font-family: Arial, sans-serif; /* 폰트 설정 */
  background-color: #f5f5f5; /* 배경 색상 */
}

/* 폼 스타일 */
.form-board {
  width: 80%; /* 폼 너비 */
  margin: 20px auto; /* 중앙 정렬과 상하 여백 */
  padding: 20px;
  background-color: white; /* 배경색 */
  box-shadow: 0 0 10px rgba(0,0,0,0.1); /* 그림자 효과 */
}

/* 제목 입력 필드 */
.input-title {
  width: 100%; /* 너비 전체 사용 */
  padding: 10px; /* 패딩 */
  margin-bottom: 15px; /* 하단 여백 */
  border: 2px solid #3CB371; /* 테두리 색상 */
  box-sizing: border-box; /* 박스 모델 조정 */
}

/* 이미지 박스 */
.img-box {
  display: flex;
  gap: 10px;
}

.preview {
  width: 100px; /* 미리보기 이미지 크기 */
  height: 100px;
  object-fit: cover; /* 이미지 비율 유지 */
}

/* 텍스트 영역 */
.textarea-content {
  width: 100%;
  height: 300px; /* 높이 설정 */
  border: 2px solid #3CB371;
  padding: 10px;
  box-sizing: border-box;
}

/* 버튼 스타일 */
.button-submit {
  background-color: #3CB371; /* 배경색 */
  color: white; /* 글자색 */
  border: none;
  padding: 10px 20px;
  cursor: pointer;
  border-radius: 5px;
}

.button-submit:hover {
  background-color: #2e8b57; /* 호버 시 색상 변경 */
}

/* 반응형 디자인 */
@media (max-width: 768px) {
  .form-board {
    width: 90%;
    padding: 10px;
  }
}

  </style>
</head>
<body>

  <th:block th:replace="~{common/header}"></th:block>

  <form th:action="@{update}" th:object="${board}" method="POST" class="board-write" id="boardUpdateFrm"
            enctype="multipart/form-data">

            <h1 class="board-name" th:text="${boardName}">게시판 이름</h1>

            <!-- 제목 -->
            <h1 class="board-title">
                <input type="text" name="boardTitle" placeholder="제목" th:value="${board.boardTitle}">
            </h1>

            
            <!-- 내용 -->
            <div class="board-content">
              <textarea name="boardContent" th:text="*{boardContent}">게시글 내용</textarea>
            </div>


        <!-- 테스트 -->
        
          
           <!-- 미리보기 이미지들을 담을 컨테이너 -->
      



<!-- 이미지들 -->
  <div id="previewContainer">
<th:block th:each="image, iterStat : ${board.imageList}">
  <!-- iterStat.index를 사용하여 각 img 태그와 삭제 버튼에 고유한 id를 부여합니다. -->
  <img class="preview" th:id="'img' + ${image.imgOrder}" src="" />
  <span class="delete-image" th:id="${image.imgOrder}">&times;</span>
</th:block>
</div>

<h5>이미지</h5>
<div class="img-box">
  <div class="boardImg thumbnail">
    <input type="file" name="images" id="imageUpload" class="inputImage" accept="image/*" multiple>

  </div>



</div>


            <!-- 버튼 영역 -->
            <div class="board-btn-area">
                <button type="submit" id="writebtn">등록</button>
            </div>

            
            <!-- 기존 이미지가 있다가 삭제된 이미지의 순서를 기록 *****확인 필요******* -->
            <input type="hidden" name="deleteOrder" value="">

            <!-- 수정 성공 시 주소(쿼리스트링) 유지용도 *****확인 필요******* -->
            <input type="hidden" name="querystring">
        </form>





          <hr><hr><hr>


      








  <!-- 이미지 미리보기 설정 -->
<!--   <script th:inline="javascript">

    const imageList = /*[[${board.imageList}]]*/[];

    const previewList = document.querySelectorAll('img.preview');

    const orderList = []; // 기존에 존재하던 이미지 순서를 기록

    for (let img of imageList) {
      previewList[img.imgOrder].src = img.imgPath + img.imgRename;

      orderList.push(img.imgOrder);
    }

  </script> -->

  <!-- 테스트 -->
  <script th:inline="javascript">
    const imageList = /*[[${board.imageList}]]*/[];
    const previewList = document.querySelectorAll('img.preview');
    const orderList = []; // 기존에 존재하던 이미지 순서를 기록

    imageList.forEach((img) => {
        if (img.imgOrder < previewList.length) { // 인덱스 유효성 검사
            const previewImg = previewList[img.imgOrder];
            if (previewImg) { // 해당 인덱스의 요소가 존재하는지 확인
                previewImg.src = img.imgPath + img.imgRename;
                orderList.push(img.imgOrder);
            }
        }
    });
</script>
  <!-- 테스트끝 -->



  <th:block th:replace="~{common/footer}"></th:block>

  <script src="/js/board/boardUpdate.js"></script>
  
</body>
</html>